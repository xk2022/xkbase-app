import{r as l,j as e}from"./react-DwkAs-v9.js";import{K as v,e as _,C as U,h as K,P as D}from"./index-BdFDZIEO.js";import{f as q,d as H,u as $,c as M}from"./Query-UyplWv-j.js";import{C as V}from"./ConfirmDeleteModal-BwZdlGN4.js";import{a as B,g as G,d as Y,e as I,f as z}from"./react-router-Df4HDh8c.js";import{S as J}from"./react-bootstrap-BUaeuJHt.js";import"./apexcharts-sziEC8OT.js";import"./react-dom-DVTd-Q6a.js";import"./scheduler-CylivXx-.js";import"./axios-mH-cpkvd.js";import"./formik-B67XZPDW.js";import"./deepmerge-DhIoniG1.js";import"./lodash-es-ClCkCI8n.js";import"./react-fast-compare-0sFLRPh9.js";import"./hoist-non-react-statics-C-8QU_9G.js";import"./react-is-8JwjhRSi.js";import"./yup-BLKqc-jj.js";import"./property-expr-DEi1ZLzV.js";import"./tiny-case-BJ7jYKNY.js";import"./toposort-7gDswQQa.js";import"./clsx-B-dksMZM.js";import"./react-router-dom-BJfVfmV5.js";import"./@remix-run-DUdlTjFu.js";import"./chart.js-xWmoy_ii.js";import"./@kurkle-D8fDXNIl.js";import"./@tanstack-BGZqBxWN.js";import"./react-copy-to-clipboard-C4AWj7CK.js";import"./copy-to-clipboard-BvYTofsP.js";import"./toggle-selection-BHUZwh74.js";import"./prism-react-renderer-BV8xJdsO.js";import"./react-select-Z1ywkuii.js";import"./@babel-B036hIWL.js";import"./@emotion-Cdt29Dgm.js";import"./stylis-YPZU7XtI.js";import"./@floating-ui-DZ2V_EUC.js";import"./use-isomorphic-layout-effect-CgCMJW-V.js";import"./memoize-one-DxrTgWdQ.js";import"./@popperjs-D8Kg5PqX.js";import"./react-topbar-progress-indicator-BI-R5WY2.js";import"./topbar-C3UDlew2.js";import"./bootstrap-D7dJWYZj.js";import"./classnames-Bztn78Bv.js";import"./dom-helpers-C9Bu-4wA.js";import"./@restart-rvtB3BAN.js";import"./dequal-tFQomdd2.js";import"./warning-DaFg7xBm.js";import"./prop-types-smO-eibg.js";import"./uncontrollable-C0VNg-tm.js";import"./react-transition-group-DSbRRiC3.js";const Q=10,W=({searchKeyword:s,showAlert:r,onEdit:a})=>{const[i,c]=l.useState([]),[d,x]=l.useState(0),[o,h]=l.useState(1),[b,N]=l.useState(1),[w,g]=l.useState(!1),[p,f]=l.useState(null),[S,y]=l.useState(!1),u=B(),E=l.useCallback(async()=>{g(!0);const n={page:b-1,size:Q,keyword:s||void 0},j=await q(n,r);c(j.content),x(j.totalElements),h(j.totalPages||1),g(!1)},[b,s,r]);l.useEffect(()=>{N(1)},[s]),l.useEffect(()=>{E()},[E]);const T=n=>{f(n)},C=async()=>{if(p)try{y(!0),await H(p.uuid,r)&&(r("刪除車輛成功","success"),await E(),f(null))}finally{y(!1)}};return e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"table-responsive",children:e.jsxs("table",{className:"table align-middle table-row-dashed fs-6 gy-5",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"text-start text-muted fw-bolder fs-7 text-uppercase gs-0",children:[e.jsx("th",{className:"min-w-150px",children:"車牌"}),e.jsx("th",{className:"min-w-125px",children:"車種"}),e.jsx("th",{className:"min-w-125px",children:"狀態"}),e.jsx("th",{className:"min-w-80px",children:"可派遣"}),e.jsx("th",{className:"min-w-125px",children:"里程數"}),e.jsx("th",{className:"min-w-80px",children:"司機"}),e.jsx("th",{className:"min-w-125px text-end",children:"功能"})]})}),e.jsx("tbody",{children:w?e.jsx("tr",{children:e.jsx("td",{colSpan:7,className:"text-center py-10",children:"載入中…"})}):i.length>0?i.map(n=>e.jsxs("tr",{className:"cursor-pointer table-row-hover",onClick:()=>u(`/fms/vehicle/${n.uuid}/detail`),children:[e.jsx("td",{children:n.plateNo}),e.jsx("td",{children:n.type}),e.jsx("td",{children:n.status==="AVAILABLE"||n.status==="IDLE"?e.jsx("span",{className:"badge badge-light-success fw-bolder px-4 py-3",children:n.status}):n.status==="IN_USE"?e.jsx("span",{className:"badge badge-light-warning fw-bolder px-4 py-3",children:"執行中"}):n.status==="MAINTENANCE"?e.jsx("span",{className:"badge badge-light-danger fw-bolder px-4 py-3",children:"維修中"}):e.jsx("span",{className:"badge badge-light-secondary fw-bolder px-4 py-3",children:n.status})}),e.jsx("td",{children:n.enabled?e.jsx("span",{className:"badge badge-light-success fw-bolder px-4 py-3",children:"可派遣"}):e.jsx("span",{className:"badge badge-light-secondary fw-bolder px-4 py-3",children:"停用"})}),e.jsx("td",{children:n.currentOdometer??"-"}),e.jsx("td",{children:n.currentDriverId?e.jsx(v,{iconName:"user",className:"fs-2 text-primary"}):e.jsx("span",{className:"text-muted",children:"無"})}),e.jsxs("td",{className:"text-end",children:[e.jsxs("button",{className:"btn btn-sm btn-warning",onClick:j=>{j.stopPropagation(),a(n)},children:[e.jsx(v,{iconName:"message-edit",className:"fs-2"}),"編輯"]}),e.jsxs("button",{className:"btn btn-sm btn-danger ms-2",onClick:j=>{j.stopPropagation(),T(n)},children:[e.jsx(v,{iconName:"cross",className:"fs-2"}),"刪除"]})]})]},n.uuid)):e.jsx("tr",{children:e.jsx("td",{colSpan:7,className:"text-center text-muted py-10",children:"尚無車輛資料"})})})]})}),e.jsxs("div",{className:"d-flex justify-content-between align-items-center mt-4",children:[e.jsxs("span",{className:"text-muted",children:["第 ",b," / ",o," 頁，共 ",d," 筆"]}),e.jsxs("div",{className:"d-flex gap-2",children:[e.jsx("button",{className:"btn btn-sm btn-light",disabled:b<=1,onClick:()=>N(n=>Math.max(1,n-1)),children:"上一頁"}),e.jsx("button",{className:"btn btn-sm btn-light",disabled:b>=o,onClick:()=>N(n=>Math.min(o,n+1)),children:"下一頁"})]})]}),p&&e.jsx(V,{open:!!p,title:"刪除車輛",deleting:S,message:e.jsxs("p",{children:["是否確定要刪除車輛「",e.jsx("strong",{children:p.plateNo}),"」？"]}),onClose:()=>S?null:f(null),onConfirm:C})]})},X=[{value:"TRACTOR",label:"車頭"},{value:"TRAILER_20",label:"20 尺板車"},{value:"TRAILER_40",label:"40 尺板車"},{value:"SMALL_TRUCK",label:"小貨車 / 小型貨車"},{value:"REFRIGERATED_TRUCK",label:"冷凍車"},{value:"VAN",label:"廂型車"},{value:"OTHER",label:"其他"}],Z=[{value:"AVAILABLE",label:"可用 / 空閒 (AVAILABLE)"},{value:"IDLE",label:"閒置 (IDLE)"},{value:"IN_USE",label:"執行中 (IN_USE)"},{value:"BUSY",label:"忙碌 (BUSY)"},{value:"MAINTENANCE",label:"維修中 (MAINTENANCE)"},{value:"RESERVED",label:"已預約 (RESERVED)"},{value:"INACTIVE",label:"停用 (INACTIVE)"},{value:"SCRAPPED",label:"報廢 (SCRAPPED)"}],ee=({open:s,onClose:r,showAlert:a,onSaved:i,editingVehicle:c})=>{const[d,x]=l.useState(""),[o,h]=l.useState(""),[b,N]=l.useState(""),[w,g]=l.useState(""),[p,f]=l.useState(""),[S,y]=l.useState("AVAILABLE"),[u,E]=l.useState(!0),[T,C]=l.useState(""),[n,j]=l.useState(""),[m,k]=l.useState(!1),R=!!c;if(l.useEffect(()=>{if(!c){x(""),h(""),N(""),g(""),f(""),y("AVAILABLE"),E(!0),C(""),j("");return}x(c.plateNo),h(c.type),N(c.brand??""),g(c.model??""),f(c.capacityTon!=null?String(c.capacityTon):""),y(c.status),E(c.enabled),C(c.currentOdometer!=null?String(c.currentOdometer):""),j(c.remark??"")},[c]),!s)return null;const O=t=>{if(!t.trim())return;const A=Number(t);return Number.isNaN(A)?void 0:A},F=async()=>{if(!d.trim()){a("請輸入車牌號碼","warning");return}if(!o){a("請選擇車種","warning");return}try{k(!0);const t={plateNo:d.trim(),type:o,brand:b.trim()||void 0,model:w.trim()||void 0,capacityTon:O(p),status:S,enabled:u,currentOdometer:O(T),remark:n.trim()||void 0};let A=!1;if(R&&c){const L={...t};A=await $(c.uuid,L,a)}else{const L={...t};A=await M(L,a)}A&&i()}finally{k(!1)}};return e.jsx("div",{className:"modal fade show d-block",tabIndex:-1,style:{backgroundColor:"rgba(0,0,0,.25)"},children:e.jsx("div",{className:"modal-dialog modal-lg",children:e.jsxs("div",{className:"modal-content",children:[e.jsxs("div",{className:"modal-header",children:[e.jsxs("h5",{className:"modal-title",children:[e.jsx(v,{iconName:R?"message-edit":"plus",className:"fs-2 me-2"}),R?"編輯車輛":"新增車輛"]}),e.jsx("button",{type:"button",className:"btn btn-sm btn-light",onClick:r,disabled:m,children:"×"})]}),e.jsx("div",{className:"modal-body",children:e.jsxs("div",{className:"row g-5",children:[e.jsxs("div",{className:"col-md-6 d-flex flex-column gap-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"form-label required",children:"車牌號碼（plateNo）"}),e.jsx("input",{className:"form-control",value:d,onChange:t=>x(t.target.value),placeholder:"例如：ABC-1234"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"form-label required",children:"車種（type）"}),e.jsxs("select",{className:"form-select",value:o,onChange:t=>h(t.target.value),children:[e.jsx("option",{value:"",children:"請選擇車種"}),X.map(t=>e.jsxs("option",{value:t.value,children:[t.label,"（",t.value,"）"]},t.value))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"form-label",children:"品牌（brand）"}),e.jsx("input",{className:"form-control",value:b,onChange:t=>N(t.target.value),placeholder:"例如：FUSO、HINO、SCANIA"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"form-label",children:"車款 / 型號（model）"}),e.jsx("input",{className:"form-control",value:w,onChange:t=>g(t.target.value),placeholder:"例如：Canter 3.5T、Actros 2653"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"form-label",children:"核定載重（噸）（capacityTon）"}),e.jsx("input",{className:"form-control",type:"number",step:"0.1",value:p,onChange:t=>f(t.target.value),placeholder:"例如：3.5"})]})]}),e.jsxs("div",{className:"col-md-6 d-flex flex-column gap-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"form-label required",children:"車輛狀態（status）"}),e.jsx("select",{className:"form-select",value:S,onChange:t=>y(t.target.value),children:Z.map(t=>e.jsx("option",{value:t.value,children:t.label},t.value))})]}),e.jsxs("div",{className:"form-check form-switch form-check-custom form-check-solid mt-2",children:[e.jsx("input",{className:"form-check-input",type:"checkbox",id:"vehicleEnabledSwitch",checked:u,onChange:t=>E(t.target.checked)}),e.jsx("label",{className:"form-check-label",htmlFor:"vehicleEnabledSwitch",children:"可指派 / 啟用（enabled）"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"form-label",children:"目前里程數（km）"}),e.jsx("input",{className:"form-control",type:"number",step:"1",value:T,onChange:t=>C(t.target.value),placeholder:"例如：125000"}),e.jsx("div",{className:"form-text",children:"主要用於之後的保養 / 維修提醒，可選填。"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"form-label",children:"備註（remark）"}),e.jsx("textarea",{className:"form-control",rows:3,value:n,onChange:t=>j(t.target.value),placeholder:"可填寫車況、輪胎狀況、冷凍機型號、特殊用途等說明"})]})]})]})}),e.jsxs("div",{className:"modal-footer",children:[e.jsx("button",{className:"btn btn-light",onClick:r,disabled:m,children:"取消"}),e.jsx("button",{className:"btn btn-primary",onClick:F,disabled:m,children:m?"儲存中…":"儲存"})]})]})})})},se=()=>{const{alert:s,showAlert:r,Alert:a}=_(),[i,c]=l.useState(!1),[d,x]=l.useState(null),[o,h]=l.useState(""),[b,N]=l.useState(""),[w,g]=l.useState(0),p=u=>{u.key==="Enter"&&h(b.trim())},f=()=>{g(u=>u+1),c(!1),x(null)},S=()=>{x(null),c(!0)},y=u=>{x(u),c(!0)};return e.jsxs(U,{children:[s&&e.jsx(a,{message:s.message,type:s.type}),e.jsx("div",{className:"",children:e.jsxs("ol",{className:"breadcrumb text-muted fs-6 fw-bold",children:[e.jsx("li",{className:"breadcrumb-item pe-3",children:e.jsx("a",{href:"#",className:"pe-3",children:"FMS 車輛管理"})}),e.jsx("li",{className:"breadcrumb-item px-3 text-muted",children:"車輛列表"})]})}),e.jsx("div",{className:"app-content flex-column-fluid",children:e.jsxs("div",{className:"card",children:[e.jsxs("div",{className:"card-header border-0 pt-6",children:[e.jsx("div",{className:"card-title",children:e.jsxs("div",{className:"d-flex align-items-center position-relative my-1",children:[e.jsx(v,{iconName:"magnifier",className:"fs-1 position-absolute ms-6"}),e.jsx("input",{type:"text",className:"form-control form-control-solid w-250px ps-14",placeholder:"搜尋車牌 / 車種 / 品牌",value:b,onChange:u=>N(u.target.value),onKeyDown:p})]})}),e.jsx("div",{className:"card-toolbar",children:e.jsxs("button",{type:"button",className:"btn btn-primary",onClick:S,children:[e.jsx(v,{iconName:"plus",className:"fs-2"}),"新增車輛"]})})]}),e.jsx("div",{className:"card-body py-4",children:e.jsx(W,{searchKeyword:o,showAlert:r,onEdit:y},w)})]})}),e.jsx(ee,{open:i,onClose:()=>{c(!1),x(null)},showAlert:r,editingVehicle:d,onSaved:f})]})},ae=({mode:s,submitting:r=!1,initialValues:a,onSubmit:i,onCancel:c})=>{const[d,x]=l.useState(""),[o,h]=l.useState("TRACTOR"),[b,N]=l.useState(""),[w,g]=l.useState(""),[p,f]=l.useState(""),[S,y]=l.useState("AVAILABLE"),[u,E]=l.useState(!0),[T,C]=l.useState(""),n=s==="edit";l.useEffect(()=>{a&&(a.plateNo!==void 0&&x(a.plateNo),a.type!==void 0&&h(a.type),a.brand!==void 0&&N(a.brand||""),a.model!==void 0&&g(a.model||""),a.capacityTon!==void 0&&f(String(a.capacityTon)),a.status!==void 0&&y(a.status),a.enabled!==void 0&&E(a.enabled),a.remark!==void 0&&C(a.remark||""))},[a]);const j=async m=>{if(m.preventDefault(),!d.trim()){alert("請輸入車牌號碼");return}const k={plateNo:d.trim(),type:o,brand:b||void 0,model:w||void 0,capacityTon:p?Number(p):void 0,status:S,enabled:u,remark:T||void 0};await i(k)};return e.jsxs("form",{className:"form",noValidate:!0,onSubmit:j,children:[e.jsxs("div",{className:"row g-5",children:[e.jsxs("div",{className:"col-md-6 d-flex flex-column gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"form-label required",children:"車牌號碼（plateNo）"}),e.jsx("input",{className:"form-control",value:d,onChange:m=>x(m.target.value),placeholder:"例如：ABC-1234"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"form-label required",children:"車種（type）"}),e.jsxs("select",{className:"form-select",value:o,onChange:m=>h(m.target.value),children:[e.jsx("option",{value:"TRACTOR",children:"車頭（Tractor）"}),e.jsx("option",{value:"TRAILER_20",children:"20 尺板車"}),e.jsx("option",{value:"TRAILER_40",children:"40 尺板車"}),e.jsx("option",{value:"REFRIGERATOR",children:"冷凍車"}),e.jsx("option",{value:"LIGHT_TRUCK",children:"小貨車"}),e.jsx("option",{value:"OTHER",children:"其他"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"form-label",children:"品牌（brand）"}),e.jsx("input",{className:"form-control",value:b,onChange:m=>N(m.target.value),placeholder:"例如：VOLVO / SCANIA"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"form-label",children:"型號（model）"}),e.jsx("input",{className:"form-control",value:w,onChange:m=>g(m.target.value),placeholder:"例如：FH16 / P410"})]})]}),e.jsxs("div",{className:"col-md-6 d-flex flex-column gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"form-label",children:"載重（噸數, capacityTon）"}),e.jsx("input",{className:"form-control",type:"number",min:0,step:"0.1",value:p,onChange:m=>f(m.target.value),placeholder:"例如：3.5"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"form-label required",children:"車輛狀態（status）"}),e.jsxs("select",{className:"form-select",value:S,onChange:m=>y(m.target.value),children:[e.jsx("option",{value:"AVAILABLE",children:"可接單（AVAILABLE）"}),e.jsx("option",{value:"IN_USE",children:"使用中（IN_USE）"}),e.jsx("option",{value:"MAINTENANCE",children:"維修（MAINTENANCE）"}),e.jsx("option",{value:"INACTIVE",children:"停用（INACTIVE）"}),e.jsx("option",{value:"SCRAPPED",children:"報廢（SCRAPPED）"})]})]}),e.jsxs("div",{className:"form-check form-switch form-check-custom form-check-solid",children:[e.jsx("input",{className:"form-check-input",type:"checkbox",id:"vehicleEnabledSwitch",checked:u,onChange:m=>E(m.target.checked)}),e.jsx("label",{className:"form-check-label",htmlFor:"vehicleEnabledSwitch",children:"啟用（可指派）"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"form-label",children:"備註（remark）"}),e.jsx("textarea",{className:"form-control",rows:3,value:T,onChange:m=>C(m.target.value),placeholder:"例如：固定給 A 司機、車況良好、新車…"})]})]})]}),e.jsxs("div",{className:"mt-8 d-flex justify-content-end",children:[c&&e.jsx("button",{type:"button",className:"btn btn-light me-3",onClick:c,disabled:r,children:"取消"}),e.jsx("button",{type:"submit",className:"btn btn-primary",disabled:r,children:r?e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"indicator-label",children:"儲存中…"}),e.jsxs("span",{className:"indicator-progress",children:["請稍候…",e.jsx("span",{className:"spinner-border spinner-border-sm align-middle ms-2"})]})]}):e.jsxs(e.Fragment,{children:[e.jsx(v,{iconName:n?"message-edit":"plus",className:"fs-2 me-2"}),n?"更新資料":"建立車輛"]})})]})]})},le=()=>{const s=B(),[r,a]=l.useState(!1),i=async d=>{a(!0);const x={plateNo:d.plateNo.trim(),type:d.type,brand:d.brand||void 0,model:d.model||void 0,capacityTon:d.capacityTon?Number(d.capacityTon):void 0,status:d.status,enabled:d.enabled??!0,remark:d.remark||void 0},o=await M(x);a(!1),o?s("/fms/vehicle/list"):console.error("新增車輛失敗")},c=()=>{s(-1)};return e.jsxs("div",{className:"card",children:[e.jsx("div",{className:"card-header",children:e.jsx("h2",{className:"card-title",children:"新增車輛"})}),e.jsx("div",{className:"card-body",children:e.jsx(ae,{mode:"create",submitting:r,onSubmit:i,onCancel:c})})]})},te=s=>({uuid:s.id,plateNo:s.plateNo,type:s.type,brand:s.brand??void 0,model:s.model??void 0,capacityTon:s.capacityTon??null,status:s.status,enabled:s.enabled,currentDriverId:s.currentDriverId??null,currentDriverName:s.currentDriverName??null,currentOdometer:s.currentOdometer??null,remark:s.remark??null,createdTime:s.createdTime,updatedTime:s.updatedTime,driver:s.driver??null,recentMaintenances:s.recentMaintenances??[]});async function re(s,r){try{const i=(await K.get(`/api/fms/vehicles/${s}`)).data.data;return i?te(i):null}catch(a){return console.error(a),null}}const ce=({detail:s,reload:r})=>e.jsxs("div",{className:"card mb-5 mb-xl-8",children:[e.jsxs("div",{className:"card-header border-0 pt-5",children:[e.jsxs("h3",{className:"card-title align-items-start flex-column",children:[e.jsx("span",{className:"card-label fw-bolder text-dark",children:"車輛基本資訊"}),e.jsxs("span",{className:"text-muted mt-1 fw-semibold",children:[s.plateNo," · ",s.type]})]}),r&&e.jsx("div",{className:"card-toolbar",children:e.jsxs("button",{type:"button",className:"btn btn-sm btn-light",onClick:r,children:[e.jsx(v,{iconName:"refresh",className:"fs-4 me-1"}),"重新整理"]})})]}),e.jsxs("div",{className:"card-body pt-3",children:[e.jsxs("div",{className:"mb-4",children:[e.jsx("div",{className:"text-muted",children:"車牌號碼"}),e.jsx("div",{className:"fs-6 fw-bold",children:s.plateNo})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("div",{className:"text-muted",children:"車種"}),e.jsx("div",{className:"fs-6 fw-bold",children:s.type})]}),e.jsxs("div",{className:"mb-4 row",children:[e.jsxs("div",{className:"col-6",children:[e.jsx("div",{className:"text-muted",children:"品牌"}),e.jsx("div",{className:"fs-6 fw-bold",children:s.brand||"-"})]}),e.jsxs("div",{className:"col-6",children:[e.jsx("div",{className:"text-muted",children:"型號"}),e.jsx("div",{className:"fs-6 fw-bold",children:s.model||"-"})]})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("div",{className:"text-muted",children:"載重（噸）"}),e.jsx("div",{className:"fs-6 fw-bold",children:s.capacityTon!=null?`${s.capacityTon} 噸`:"-"})]}),e.jsxs("div",{className:"mb-2",children:[e.jsx("div",{className:"text-muted",children:"備註"}),e.jsx("div",{className:"fs-6",children:s.remark&&s.remark.trim().length>0?s.remark:e.jsx("span",{className:"text-muted",children:"尚未填寫"})})]})]})]}),ne=({detail:s,reload:r})=>{const a=(()=>{switch(s.status){case"IDLE":return{label:"閒置",className:"badge-light-success"};case"IN_USE":return{label:"執行中",className:"badge-light-primary"};case"MAINTENANCE":return{label:"維修中",className:"badge-light-warning"};case"RESERVED":return{label:"已預約",className:"badge-light-info"};case"SCRAPPED":return{label:"報廢 / 停用",className:"badge-light-danger"};default:return{label:s.status,className:"badge-light-secondary"}}})();return e.jsxs("div",{className:"card mb-5 mb-xl-8",children:[e.jsxs("div",{className:"card-header border-0 pt-5",children:[e.jsxs("h3",{className:"card-title align-items-start flex-column",children:[e.jsx("span",{className:"card-label fw-bolder text-dark",children:"狀態與里程"}),e.jsx("span",{className:"text-muted mt-1 fw-semibold",children:"即時掌握車輛可用狀態"})]}),r&&e.jsx("div",{className:"card-toolbar",children:e.jsxs("button",{type:"button",className:"btn btn-sm btn-light",onClick:r,children:[e.jsx(v,{iconName:"refresh",className:"fs-4 me-1"}),"重新整理"]})})]}),e.jsxs("div",{className:"card-body pt-3",children:[e.jsxs("div",{className:"mb-4",children:[e.jsx("div",{className:"text-muted",children:"車輛狀態"}),e.jsx("div",{className:"mt-1",children:e.jsx("span",{className:`badge fw-bolder px-4 py-3 ${a.className}`,children:a.label})})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("div",{className:"text-muted",children:"是否可指派"}),e.jsx("div",{className:"mt-1",children:s.enabled?e.jsx("span",{className:"badge badge-light-success fw-bolder px-4 py-3",children:"可指派"}):e.jsx("span",{className:"badge badge-light-secondary fw-bolder px-4 py-3",children:"不可指派"})})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("div",{className:"text-muted",children:"目前里程數"}),e.jsx("div",{className:"fs-6 fw-bold",children:s.currentOdometer!=null?`${s.currentOdometer.toLocaleString()} km`:"-"})]}),e.jsxs("div",{className:"mb-2 row",children:[e.jsxs("div",{className:"col-6",children:[e.jsx("div",{className:"text-muted",children:"建立時間"}),e.jsx("div",{className:"fs-7",children:s.createdTime||e.jsx("span",{className:"text-muted",children:"-"})})]}),e.jsxs("div",{className:"col-6",children:[e.jsx("div",{className:"text-muted",children:"最後更新"}),e.jsx("div",{className:"fs-7",children:s.updatedTime||e.jsx("span",{className:"text-muted",children:"-"})})]})]})]})]})},de=({detail:s,reload:r})=>{var i;const a=s.driver;return e.jsxs("div",{className:"card mb-5 mb-xl-8",children:[e.jsxs("div",{className:"card-header border-0 pt-5",children:[e.jsxs("h3",{className:"card-title align-items-start flex-column",children:[e.jsx("span",{className:"card-label fw-bolder text-dark",children:"綁定司機"}),e.jsx("span",{className:"text-muted mt-1 fw-semibold",children:"顯示目前指派此車輛的司機資訊"})]}),r&&e.jsx("div",{className:"card-toolbar",children:e.jsxs("button",{type:"button",className:"btn btn-sm btn-light",onClick:r,children:[e.jsx(v,{iconName:"refresh",className:"fs-4 me-1"}),"重新整理"]})})]}),e.jsxs("div",{className:"card-body pt-3",children:[a?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"mb-3 d-flex align-items-center",children:[e.jsx("div",{className:"symbol symbol-45px me-3",children:e.jsx("div",{className:"symbol-label bg-light-primary text-primary fw-bold",children:((i=a.name)==null?void 0:i[0])??"司"})}),e.jsxs("div",{children:[e.jsx("div",{className:"fw-bolder fs-6",children:a.name}),e.jsx("div",{className:"text-muted fs-7",children:a.licenseType||"—"})]})]}),e.jsxs("div",{className:"mb-3",children:[e.jsx("div",{className:"text-muted",children:"聯絡電話"}),e.jsx("div",{className:"fs-6 fw-bold",children:a.phone||e.jsx("span",{className:"text-muted",children:"尚未填寫"})})]}),e.jsxs("div",{className:"mb-3",children:[e.jsx("div",{className:"text-muted",children:"上線狀態"}),e.jsx("div",{className:"mt-1",children:a.onDuty?e.jsx("span",{className:"badge badge-light-success fw-bolder px-4 py-3",children:"上線中"}):e.jsx("span",{className:"badge badge-light-secondary fw-bolder px-4 py-3",children:"未上線"})})]})]}):e.jsx("div",{className:"text-muted",children:"目前尚未綁定司機，可由調度員於指派流程中設定。"}),e.jsx("div",{className:"mt-5",children:e.jsxs("button",{type:"button",className:"btn btn-sm btn-light-primary",disabled:!0,children:[e.jsx(v,{iconName:"swap",className:"fs-4 me-1"}),"變更綁定司機（預留）"]})})]})]})},ie=({detail:s})=>{const r=s.recentMaintenances??[];return e.jsxs("div",{className:"card mb-5 mb-xl-8",children:[e.jsxs("div",{className:"card-header border-0 pt-5",children:[e.jsxs("h3",{className:"card-title align-items-start flex-column",children:[e.jsx("span",{className:"card-label fw-bolder text-dark",children:"維修 / 保養紀錄（最近）"}),e.jsx("span",{className:"text-muted mt-1 fw-semibold",children:"後端目前可先回空陣列，畫面預留結構"})]}),e.jsx("div",{className:"card-toolbar",children:e.jsxs("button",{type:"button",className:"btn btn-sm btn-light",disabled:!0,children:[e.jsx(v,{iconName:"plus",className:"fs-4 me-1"}),"新增維修紀錄（預留）"]})})]}),e.jsx("div",{className:"card-body pt-3",children:r.length===0?e.jsx("div",{className:"text-muted",children:"目前尚無維修 / 保養紀錄。未來可在此呈現最近 5 筆紀錄，以及連結至完整列表。"}):e.jsx("div",{className:"table-responsive",children:e.jsxs("table",{className:"table align-middle table-row-dashed fs-6 gy-4",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"text-start text-muted fw-bolder fs-7 text-uppercase gs-0",children:[e.jsx("th",{className:"min-w-100px",children:"日期"}),e.jsx("th",{className:"min-w-120px",children:"種類"}),e.jsx("th",{className:"min-w-100px",children:"里程數"}),e.jsx("th",{className:"min-w-200px",children:"說明"})]})}),e.jsx("tbody",{children:r.map(a=>e.jsxs("tr",{children:[e.jsx("td",{children:a.date}),e.jsx("td",{children:a.type}),e.jsx("td",{children:a.mileage!=null?`${a.mileage.toLocaleString()} km`:"-"}),e.jsx("td",{children:a.description||"-"})]},a.id))})]})})})]})},me=()=>{const{id:s}=G(),[r,a]=l.useState(!0),[i,c]=l.useState(null),[d,x]=l.useState(null),o=l.useCallback(async()=>{if(s)try{a(!0),x(null);const h=await re(s);h||x("找不到車輛資料"),c(h)}catch(h){console.error(h),x("取得車輛詳情失敗，請稍後再試")}finally{a(!1)}},[s]);return l.useEffect(()=>{o()},[o]),s?r?e.jsx("div",{className:"d-flex justify-content-center py-10",children:e.jsx(J,{animation:"border",role:"status",children:e.jsx("span",{className:"visually-hidden",children:"載入中…"})})}):d||!i?e.jsx("div",{className:"alert alert-danger",children:d??"車輛資料不存在"}):e.jsxs("div",{className:"row",children:[e.jsx("div",{className:"col-12 col-xl-4 mb-5",children:e.jsx(ce,{detail:i,reload:o})}),e.jsx("div",{className:"col-12 col-xl-4 mb-5",children:e.jsx(ne,{detail:i,reload:o})}),e.jsx("div",{className:"col-12 col-xl-4 mb-5",children:e.jsx(de,{detail:i,reload:o})}),e.jsx("div",{className:"col-12 mb-5",children:e.jsx(ie,{detail:i})})]}):e.jsx("div",{className:"alert alert-danger",children:"缺少車輛 ID"})},P=[{title:"車輛管理",path:"/fms/vehicle/overview",isSeparator:!1,isActive:!1},{title:"",path:"",isSeparator:!0,isActive:!1}],cs=()=>e.jsxs(Y,{children:[e.jsx(I,{index:!0,element:e.jsx(z,{to:"list"})}),e.jsx(I,{path:"list",element:e.jsxs(e.Fragment,{children:[e.jsx(D,{breadcrumbs:P,children:"車輛列表"}),e.jsx(se,{})]})}),e.jsx(I,{path:"create",element:e.jsxs(e.Fragment,{children:[e.jsx(D,{breadcrumbs:P,children:"新增車輛"}),e.jsx(le,{})]})}),e.jsx(I,{path:":id/detail",element:e.jsxs(e.Fragment,{children:[e.jsx(D,{breadcrumbs:P,children:"車輛詳情"}),e.jsx(me,{})]})})]});export{cs as default};
