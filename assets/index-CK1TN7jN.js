import{r as n,j as e}from"./react-DwkAs-v9.js";import{i as D,h as I,K as g,e as L,C as R,P as w}from"./index-CbhZY4ci.js";import{A as O}from"./AppToolbar-BZHSVYI7.js";import{C as W}from"./ConfirmDeleteModal-B-C_keKM.js";import{P as V}from"./PagedTable-fW2f3xMh.js";import{a as A,g as q,d as Y,e as C}from"./react-router-Df4HDh8c.js";import{u as X}from"./formik-B67XZPDW.js";import{t as F,a as z}from"./formUtils-DYBw-NTu.js";import{S as Z}from"./react-bootstrap-BUaeuJHt.js";import"./apexcharts-sziEC8OT.js";import"./react-dom-DVTd-Q6a.js";import"./scheduler-CylivXx-.js";import"./axios-mH-cpkvd.js";import"./yup-BLKqc-jj.js";import"./property-expr-DEi1ZLzV.js";import"./tiny-case-BJ7jYKNY.js";import"./toposort-7gDswQQa.js";import"./clsx-B-dksMZM.js";import"./react-router-dom-BJfVfmV5.js";import"./@remix-run-DUdlTjFu.js";import"./chart.js-xWmoy_ii.js";import"./@kurkle-D8fDXNIl.js";import"./@tanstack-BGZqBxWN.js";import"./react-copy-to-clipboard-C4AWj7CK.js";import"./copy-to-clipboard-BvYTofsP.js";import"./toggle-selection-BHUZwh74.js";import"./prism-react-renderer-BV8xJdsO.js";import"./react-select-Z1ywkuii.js";import"./@babel-B036hIWL.js";import"./@emotion-Cdt29Dgm.js";import"./hoist-non-react-statics-C-8QU_9G.js";import"./react-is-8JwjhRSi.js";import"./stylis-YPZU7XtI.js";import"./@floating-ui-DZ2V_EUC.js";import"./use-isomorphic-layout-effect-CgCMJW-V.js";import"./memoize-one-DxrTgWdQ.js";import"./@popperjs-D8Kg5PqX.js";import"./react-topbar-progress-indicator-BI-R5WY2.js";import"./topbar-C3UDlew2.js";import"./bootstrap-D7dJWYZj.js";import"./deepmerge-DhIoniG1.js";import"./lodash-es-ClCkCI8n.js";import"./react-fast-compare-0sFLRPh9.js";import"./classnames-Bztn78Bv.js";import"./dom-helpers-C9Bu-4wA.js";import"./@restart-rvtB3BAN.js";import"./dequal-tFQomdd2.js";import"./warning-DaFg7xBm.js";import"./prop-types-smO-eibg.js";import"./uncontrollable-C0VNg-tm.js";import"./react-transition-group-DSbRRiC3.js";const v=[{id:"c-001",containerNo:"OOLU1234567",type:"20GP",status:"UNASSIGNED",weight:"12800 kg",remark:"一般貨"},{id:"c-002",containerNo:"OOLU1234568",type:"20GP",status:"ASSIGNED",weight:"13150 kg",remark:"需注意破損"},{id:"c-003",containerNo:"MSCU7654321",type:"40HQ",status:"IN_PROGRESS",weight:"17320 kg",remark:"高價貨，避免碰撞"},{id:"c-004",containerNo:"TGHU9988776",type:"40HQ",status:"UNASSIGNED",weight:"18100 kg",remark:"等待裝櫃完成通知"},{id:"c-005",containerNo:"CMAU4455661",type:"45HQ",status:"DONE",weight:"16580 kg",remark:"已完成運送"},{id:"c-006",containerNo:"HLCU3344556",type:"40RH",status:"ASSIGNED",weight:"19240 kg",remark:"冷鏈貨物（需溫控）"},{id:"c-007",containerNo:"HLCU3344557",type:"40RH",status:"ASSIGNED",weight:"18890 kg",remark:"冷鏈貨物（同趟）"},{id:"c-008",containerNo:"TGHU9988777",type:"20GP",status:"IN_PROGRESS",weight:"11420 kg",remark:"一般貨"},{id:"c-009",containerNo:"OOLU8888999",type:"20GP",status:"CANCELLED",weight:"9800 kg",remark:"客戶取消"},{id:"c-010",containerNo:"CMAU4455662",type:"40RH",status:"DONE",weight:"16900 kg",remark:"冷鏈完成，已回櫃"}],G="/api/tom/container";async function J(s,t){if(D())return console.log("[Mock] 模擬建立貨櫃",s),await new Promise(a=>setTimeout(a,500)),t==null||t("貨櫃建立成功 (Mock)","success"),!0;try{return await I.post(G,s),t==null||t("貨櫃建立成功","success"),!0}catch(a){return console.error(a),t==null||t("建立貨櫃失敗，請稍後再試","danger"),!1}}async function ee(s){if(D()){console.log("[Mock] 使用 Mock 貨櫃列表",s),await new Promise(i=>setTimeout(i,300));const t=s.page*s.size,a=t+s.size,r=v.slice(t,a);return Promise.resolve({content:r,totalElements:v.length,totalPages:Math.ceil(v.length/s.size),size:s.size,number:s.page,first:s.page===0,last:a>=v.length,empty:r.length===0})}try{return(await I.get(G,{params:s})).data}catch(t){return console.error(t),{content:[],totalElements:0,totalPages:0,size:s.size,number:s.page,first:!0,last:!0,empty:!0}}}async function se(s,t){if(D())return console.log("[Mock] 模擬刪除貨櫃",s),await new Promise(a=>setTimeout(a,500)),t==null||t("貨櫃刪除成功 (Mock)","success"),!0;try{return await I.delete(`${G}/${s}`),t==null||t("貨櫃刪除成功","success"),!0}catch(a){return console.error(a),t==null||t("刪除貨櫃失敗，請稍後再試","danger"),!1}}const te=10,ae=s=>{if(!s)return"-";switch(s){case"UNASSIGNED":return"未指派";case"ASSIGNED":return"已指派";case"IN_PROGRESS":return"進行中";case"DONE":return"已完成";case"CANCELLED":return"已取消";default:return s}},re=({searchKeyword:s,showAlert:t,onEdit:a,onAssign:r})=>{const i=A(),[d,c]=n.useState([]),[N,m]=n.useState(0),[h,S]=n.useState(1),[f,y]=n.useState(1),[j,M]=n.useState(!1),[p,k]=n.useState(null),[U,_]=n.useState(!1),E=n.useCallback(async()=>{M(!0);try{const l={page:f-1,size:te,keyword:s!=null&&s.trim()?s.trim():void 0},x=await ee(l);c(x.content),m(x.totalElements),S(x.totalPages||1)}finally{M(!1)}},[f,s,t]);n.useEffect(()=>{y(1)},[s]),n.useEffect(()=>{E()},[E]);const H=n.useCallback(l=>{i(`/tom/container/${l.id}/detail`)},[i]),$=l=>k(l),B=async()=>{if(!p)return;const l=p.id;if(!l){t("缺少貨櫃識別碼，無法刪除","danger");return}try{_(!0),await se(String(l),t)&&(await E(),k(null))}finally{_(!1)}},Q=[{header:"櫃號",className:"min-w-180px"},{header:"類型",className:"min-w-100px"},{header:"狀態",className:"min-w-110px"},{header:"重量",className:"min-w-120px"},{header:"特殊需求",className:"min-w-250px"},{header:"操作",className:"min-w-260px"}];return e.jsxs(e.Fragment,{children:[e.jsx(V,{columns:Q,rows:d,loading:j,emptyText:"沒有貨櫃資料",page:f,totalPages:h,totalElements:N,onPrev:()=>y(l=>Math.max(1,l-1)),onNext:()=>y(l=>Math.min(h||1,l+1)),renderRow:l=>e.jsxs("tr",{className:"cursor-pointer table-row-hover",onClick:()=>H(l),children:[e.jsx("td",{className:"fw-bold text-gray-900",children:l.containerNo||"-"}),e.jsx("td",{children:l.type||"-"}),e.jsx("td",{children:ae(l.status)}),e.jsx("td",{children:l.weight||"-"}),e.jsx("td",{children:l.remark||"-"}),e.jsxs("td",{children:[e.jsxs("button",{className:"btn btn-sm btn-success ms-2",onClick:x=>{x.stopPropagation(),H(l)},children:[e.jsx(g,{iconName:"eye",className:"fs-2"}),"詳情"]}),r&&e.jsxs("button",{className:"btn btn-sm btn-light-primary ms-2",onClick:x=>{x.stopPropagation(),r(l)},children:[e.jsx(g,{iconName:"truck",className:"fs-2"}),"指派"]}),a&&e.jsxs("button",{className:"btn btn-sm btn-warning ms-2",onClick:x=>{x.stopPropagation(),a(l)},children:[e.jsx(g,{iconName:"message-edit",className:"fs-2"}),"編輯"]}),e.jsxs("button",{className:"btn btn-sm btn-danger ms-2",onClick:x=>{x.stopPropagation(),$(l)},children:[e.jsx(g,{iconName:"cross",className:"fs-2"}),"刪除"]})]})]},l.id)}),p&&e.jsx(W,{open:!!p,title:"刪除貨櫃",deleting:U,message:e.jsxs(e.Fragment,{children:[e.jsxs("p",{children:["確定要刪除貨櫃"," ",e.jsx("strong",{children:p.containerNo||p.id})," 嗎？"]}),e.jsx("p",{className:"text-muted mb-0",children:"此操作無法復原，請再次確認。"})]}),onClose:()=>U?null:k(null),onConfirm:B})]})};function le(){const{alert:s,showAlert:t,Alert:a}=L(),r=A(),[i,d]=n.useState(""),[c,N]=n.useState(""),[m,h]=n.useState(0),S=j=>{j.key==="Enter"&&d(c.trim())},f=()=>{r("/tom/container/create")},y=j=>{r(`/tom/container/${j.id}/detail`)};return n.useEffect(()=>{},[]),e.jsxs(R,{children:[s&&e.jsx(a,{message:s.message,type:s.type}),e.jsx(O,{title:"貨櫃列表",breadcrumbs:[{label:"管理",href:"#"},{label:"貨櫃資料",active:!0}]}),e.jsx("div",{className:"flex-column-fluid",children:e.jsxs("div",{className:"card",children:[e.jsxs("div",{className:"card-header border-0 pt-6",children:[e.jsx("div",{className:"card-title",children:e.jsxs("div",{className:"d-flex align-items-center position-relative my-1",children:[e.jsx(g,{iconName:"magnifier",className:"fs-1 position-absolute ms-6"}),e.jsx("input",{type:"text",className:"form-control form-control-solid w-250px ps-14",placeholder:"代碼 / 名稱…",value:c,onChange:j=>N(j.target.value),onKeyDown:S})]})}),e.jsx("div",{className:"card-toolbar",children:e.jsx("div",{className:"d-flex justify-content-end gap-2 flex-wrap",children:e.jsxs("button",{type:"button",className:"btn btn-primary",onClick:f,children:[e.jsx(g,{iconName:"plus",className:"fs-2"}),"新增貨櫃"]})})})]}),e.jsx("div",{className:"card-body py-4",children:e.jsx(re,{searchKeyword:i,showAlert:t,onEdit:y},m)})]})})]})}const ie=[{value:"UNASSIGNED",label:"未指派"},{value:"ASSIGNED",label:"已指派"},{value:"IN_PROGRESS",label:"進行中"},{value:"DONE",label:"已完成"},{value:"CANCELLED",label:"已取消"}],ne=[{value:"20GP",label:"20GP"},{value:"40GP",label:"40GP"},{value:"40HQ",label:"40HQ"},{value:"45HQ",label:"45HQ"},{value:"40RH",label:"40RH（冷鏈）"},{value:"OTHER",label:"其他"}],ce=({submitting:s,onSubmit:t,onCancel:a})=>{const r=X({initialValues:{containerNo:"",type:"20GP",status:"UNASSIGNED",weight:"",remark:""},onSubmit:t});return e.jsxs("form",{onSubmit:r.handleSubmit,children:[e.jsxs("div",{className:"row g-5",children:[e.jsxs("div",{className:"col-md-6",children:[e.jsx("label",{className:"form-label required",children:"貨櫃編號"}),e.jsx("input",{type:"text",className:"form-control",placeholder:"例如：OOLU1234567",...r.getFieldProps("containerNo"),required:!0,disabled:s}),e.jsx("div",{className:"form-text",children:"MVP：先手動輸入；後續可加「掃碼/校驗規則」。"})]}),e.jsxs("div",{className:"col-md-3",children:[e.jsx("label",{className:"form-label required",children:"櫃型"}),e.jsx("select",{className:"form-select",...r.getFieldProps("type"),required:!0,disabled:s,children:ne.map(i=>e.jsx("option",{value:i.value,children:i.label},i.value))})]}),e.jsxs("div",{className:"col-md-3",children:[e.jsx("label",{className:"form-label required",children:"狀態"}),e.jsx("select",{className:"form-select",...r.getFieldProps("status"),required:!0,disabled:s,children:ie.map(i=>e.jsx("option",{value:i.value,children:i.label},i.value))})]}),e.jsxs("div",{className:"col-md-6",children:[e.jsx("label",{className:"form-label",children:"重量（可選）"}),e.jsx("input",{type:"text",className:"form-control",placeholder:"例如：12800 kg",...r.getFieldProps("weight"),disabled:s}),e.jsx("div",{className:"form-text",children:"MVP：先用文字；後續再改成數字欄位 + 單位。"})]}),e.jsxs("div",{className:"col-md-12",children:[e.jsx("label",{className:"form-label",children:"特殊需求（可選）"}),e.jsx("textarea",{className:"form-control",rows:3,placeholder:"例如：冷鏈、危品、需吊掛、勿碰撞...",...r.getFieldProps("remark"),disabled:s})]})]}),e.jsxs("div",{className:"d-flex justify-content-end gap-3 mt-8",children:[e.jsx("button",{type:"button",className:"btn btn-light",onClick:a,disabled:s,children:"取消"}),e.jsx("button",{type:"submit",className:"btn btn-primary",disabled:s,children:s?"建立中…":"建立貨櫃"})]})]})},de=s=>({containerNo:F(s.containerNo),type:F(s.type),status:s.status,weight:z(s.weight)||"",remark:z(s.remark)||""}),oe=()=>{const s=A(),{alert:t,showAlert:a,Alert:r}=L(),[i,d]=n.useState(!1),c=n.useCallback(()=>{s(-1)},[s]),N=n.useCallback(async m=>{d(!0);try{const h=await J(de(m),a);a("建立貨櫃成功","success"),s("/tom/container/list")}catch(h){console.error(h),a("系統發生錯誤，請稍後再試","danger")}finally{d(!1)}},[s,a]);return e.jsxs(R,{children:[t&&e.jsx(r,{message:t.message,type:t.type}),e.jsx(O,{title:"建立貨櫃",breadcrumbs:[{label:"TOM 運輸管理",active:!1},{label:"貨櫃管理",href:"/tom/container/list",active:!1},{label:"建立貨櫃",active:!0}]}),e.jsx("div",{className:"container-fluid",children:e.jsx("div",{className:"card",children:e.jsx("div",{className:"card-body",children:e.jsx(ce,{submitting:i,onSubmit:N,onCancel:c})})})})]})},me={"c-001":{id:"1",containerNo:"OOLU1234567",type:"20GP",status:"UNASSIGNED",weight:"12800 kg",remark:"一般貨",orderId:"o-001",orderNo:"TOM-2026-0001",customerName:"宏達國際物流股份有限公司",tasks:[{taskId:"t-001-1",seq:1,fromLocation:"桃園南崁倉",toLocation:"基隆港",plannedStartAt:"2026-01-05T08:30:00+08:00",plannedEndAt:"2026-01-05T12:00:00+08:00",status:"UNASSIGNED",remark:"待指派"}],billing:{pricingMode:"PER_CONTAINER",paymentTerm:"MONTHLY",paymentStatus:"UNBILLED",currency:"TWD",subtotal:8500,tax:425,total:8925,invoiceNeeded:!0,invoiceTitle:"宏達國際物流股份有限公司",taxId:"12345678",remark:"月結 30 天"},dispatch:{status:"UNASSIGNED",etaAt:"2026-01-05T08:30:00+08:00",remark:"尚未派車"},logs:[{time:"2026-01-03T09:20:00+08:00",action:"CREATED",operator:"內勤-小林",remark:"建立貨櫃資料"},{time:"2026-01-03T10:10:00+08:00",action:"TASK_CREATED",operator:"內勤-小林",remark:"建立任務 seq=1"}]},"c-002":{id:"2",containerNo:"HLCU3344556",type:"40RH",status:"IN_PROGRESS",weight:"19240 kg",remark:"冷鏈貨物（需溫控）",orderId:"o-002",orderNo:"TOM-2026-0002",customerName:"長榮供應鏈股份有限公司",tasks:[{taskId:"t-002-1",seq:1,fromLocation:"新竹物流園區",toLocation:"台中港",plannedStartAt:"2026-01-06T07:50:00+08:00",plannedEndAt:"2026-01-06T12:30:00+08:00",driverName:"陳大偉",vehicleNo:"KAA-7788",status:"IN_PROGRESS",remark:"冷鏈文件隨車"}],billing:{pricingMode:"PER_CONTAINER",paymentTerm:"TRANSFER",paymentStatus:"BILLED",currency:"TWD",subtotal:12e3,tax:600,total:12600,invoiceNeeded:!1,remark:"已請款待入帳"},dispatch:{status:"IN_PROGRESS",driverName:"陳大偉",vehicleNo:"KAA-7788",assignedAt:"2026-01-05T15:00:00+08:00",etaAt:"2026-01-06T07:50:00+08:00",remark:"已發車"},logs:[{time:"2026-01-03T10:05:00+08:00",action:"CREATED",operator:"內勤-小張"},{time:"2026-01-05T15:00:00+08:00",action:"ASSIGNED",operator:"調度-阿宏",remark:"指派 KAA-7788 / 陳大偉"},{time:"2026-01-06T08:05:00+08:00",action:"IN_PROGRESS",operator:"司機-陳大偉",remark:"抵達取貨點"}]},"c-003":{id:"3",containerNo:"OOLU8888999",type:"20GP",status:"CANCELLED",weight:"9800 kg",remark:"客戶取消",orderId:"o-005",orderNo:"TOM-2026-0005",customerName:"鼎盛貿易股份有限公司",tasks:[{taskId:"t-005-1",seq:1,fromLocation:"台南永康工業區",toLocation:"安平港",plannedStartAt:"2026-01-10T09:00:00+08:00",plannedEndAt:"2026-01-10T12:00:00+08:00",status:"CANCELLED",remark:"提貨前取消"}],billing:{pricingMode:"PER_CONTAINER",paymentTerm:"TRANSFER",paymentStatus:"UNBILLED",currency:"TWD",subtotal:0,tax:0,total:0,invoiceNeeded:!1,remark:"已取消，未產生費用"},dispatch:{status:"CANCELLED",remark:"未派車"},logs:[{time:"2026-01-01T09:00:00+08:00",action:"CREATED",operator:"內勤-小林"},{time:"2026-01-09T16:10:00+08:00",action:"CANCELLED",operator:"內勤-小林",remark:"客戶通知取消"}]}};async function xe(s){const t=me[s];if(!t)throw new Error(`ContainerDetail not found: ${s}`);return Promise.resolve(t)}const u=s=>s==null||s===""?"-":String(s),he=({detail:s})=>e.jsxs("div",{className:"card",children:[e.jsx("div",{className:"card-header",children:e.jsx("div",{className:"card-title",children:e.jsx("h3",{className:"fw-bold m-0",children:"基本貨櫃資料"})})}),e.jsxs("div",{className:"card-body",children:[e.jsx("div",{className:"table-responsive",children:e.jsx("table",{className:"table table-row-dashed table-row-gray-300 align-middle gs-0 gy-3",children:e.jsxs("tbody",{children:[e.jsxs("tr",{children:[e.jsx("td",{className:"text-muted w-150px",children:"櫃號"}),e.jsx("td",{className:"fw-semibold",children:u(s.containerNo)})]}),e.jsxs("tr",{children:[e.jsx("td",{className:"text-muted",children:"櫃型"}),e.jsx("td",{className:"fw-semibold",children:u(s.type)})]}),e.jsxs("tr",{children:[e.jsx("td",{className:"text-muted",children:"狀態"}),e.jsx("td",{className:"fw-semibold",children:u(s.status)})]}),e.jsxs("tr",{children:[e.jsx("td",{className:"text-muted",children:"重量"}),e.jsx("td",{className:"fw-semibold",children:u(s.weight)})]}),e.jsxs("tr",{children:[e.jsx("td",{className:"text-muted",children:"特殊需求"}),e.jsx("td",{className:"fw-semibold",children:u(s.remark)})]}),e.jsxs("tr",{children:[e.jsx("td",{className:"text-muted",children:"所屬訂單"}),e.jsx("td",{className:"fw-semibold",children:u(s.orderNo)})]}),e.jsxs("tr",{children:[e.jsx("td",{className:"text-muted",children:"客戶"}),e.jsx("td",{className:"fw-semibold",children:u(s.customerName)})]})]})})}),e.jsxs("div",{className:"text-muted fs-8 mt-3",children:["ID：",u(s.id)]})]})]}),K=s=>{if(!s)return"-";const t=new Date(s);return Number.isNaN(t.getTime())?s:t.toLocaleString("zh-TW")},Ne=({detail:s})=>{const t=s.tasks||[];return e.jsxs("div",{className:"card",children:[e.jsxs("div",{className:"card-header",children:[e.jsx("div",{className:"card-title",children:e.jsx("h3",{className:"fw-bold m-0",children:"任務清單"})}),e.jsx("div",{className:"card-toolbar",children:e.jsx("button",{className:"btn btn-sm btn-light-primary",type:"button",disabled:!0,children:"新增任務（待開發）"})})]}),e.jsx("div",{className:"card-body",children:t.length===0?e.jsx("div",{className:"text-muted",children:"尚無任務資料"}):e.jsx("div",{className:"table-responsive",children:e.jsxs("table",{className:"table table-row-dashed table-row-gray-300 align-middle gs-0 gy-3",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"text-muted fw-bold",children:[e.jsx("th",{className:"min-w-70px",children:"序"}),e.jsx("th",{className:"min-w-260px",children:"起訖"}),e.jsx("th",{className:"min-w-220px",children:"時間窗"}),e.jsx("th",{className:"min-w-180px",children:"司機/車輛"}),e.jsx("th",{className:"min-w-120px",children:"狀態"}),e.jsx("th",{className:"min-w-200px",children:"備註"})]})}),e.jsx("tbody",{children:t.map(a=>{const r=[a.driverName,a.vehicleNo].filter(Boolean).join(" / ")||"-";return e.jsxs("tr",{children:[e.jsx("td",{className:"fw-semibold",children:a.seq}),e.jsx("td",{children:(a.fromLocation??"-")+" -> "+(a.toLocation??"-")}),e.jsxs("td",{children:[K(a.plannedStartAt)," ~ ",K(a.plannedEndAt)]}),e.jsx("td",{children:r}),e.jsx("td",{className:"fw-semibold",children:a.status}),e.jsx("td",{children:a.remark??"-"})]},a.taskId)})})]})})})]})},o=s=>s==null||s===""?"-":String(s),ue=({detail:s})=>{const t=s.billing;return e.jsxs("div",{className:"card",children:[e.jsxs("div",{className:"card-header",children:[e.jsx("div",{className:"card-title",children:e.jsx("h3",{className:"fw-bold m-0",children:"計費與支付方式"})}),e.jsx("div",{className:"card-toolbar",children:e.jsx("button",{className:"btn btn-sm btn-light-warning",type:"button",disabled:!0,children:"編輯（待開發）"})})]}),e.jsx("div",{className:"card-body",children:t?e.jsx("div",{className:"table-responsive",children:e.jsx("table",{className:"table table-row-dashed table-row-gray-300 align-middle gs-0 gy-3",children:e.jsxs("tbody",{children:[e.jsxs("tr",{children:[e.jsx("td",{className:"text-muted w-150px",children:"計費方式"}),e.jsx("td",{className:"fw-semibold",children:o(t.pricingMode)})]}),e.jsxs("tr",{children:[e.jsx("td",{className:"text-muted",children:"付款條件"}),e.jsx("td",{className:"fw-semibold",children:o(t.paymentTerm)})]}),e.jsxs("tr",{children:[e.jsx("td",{className:"text-muted",children:"付款狀態"}),e.jsx("td",{className:"fw-semibold",children:o(t.paymentStatus)})]}),e.jsxs("tr",{children:[e.jsx("td",{className:"text-muted",children:"小計"}),e.jsxs("td",{className:"fw-semibold",children:[o(t.subtotal)," ",o(t.currency)]})]}),e.jsxs("tr",{children:[e.jsx("td",{className:"text-muted",children:"稅額"}),e.jsxs("td",{className:"fw-semibold",children:[o(t.tax)," ",o(t.currency)]})]}),e.jsxs("tr",{children:[e.jsx("td",{className:"text-muted",children:"總計"}),e.jsxs("td",{className:"fw-semibold",children:[o(t.total)," ",o(t.currency)]})]}),e.jsxs("tr",{children:[e.jsx("td",{className:"text-muted",children:"需要發票"}),e.jsx("td",{className:"fw-semibold",children:o(t.invoiceNeeded)})]}),e.jsxs("tr",{children:[e.jsx("td",{className:"text-muted",children:"抬頭/統編"}),e.jsxs("td",{className:"fw-semibold",children:[o(t.invoiceTitle)," / ",o(t.taxId)]})]}),e.jsxs("tr",{children:[e.jsx("td",{className:"text-muted",children:"備註"}),e.jsx("td",{className:"fw-semibold",children:o(t.remark)})]})]})})}):e.jsx("div",{className:"text-muted",children:"尚未建立計費資料"})})]})},b=s=>s==null||s===""?"-":String(s),je=({detail:s})=>{const t=s.dispatch;return e.jsxs("div",{className:"card",children:[e.jsxs("div",{className:"card-header",children:[e.jsx("div",{className:"card-title",children:e.jsx("h3",{className:"fw-bold m-0",children:"派遣資訊"})}),e.jsx("div",{className:"card-toolbar",children:e.jsx("button",{className:"btn btn-sm btn-light-primary",type:"button",disabled:!0,children:"指派（待開發）"})})]}),e.jsx("div",{className:"card-body",children:t?e.jsx("div",{className:"table-responsive",children:e.jsx("table",{className:"table table-row-dashed table-row-gray-300 align-middle gs-0 gy-3",children:e.jsxs("tbody",{children:[e.jsxs("tr",{children:[e.jsx("td",{className:"text-muted w-150px",children:"狀態"}),e.jsx("td",{className:"fw-semibold",children:b(t.status)})]}),e.jsxs("tr",{children:[e.jsx("td",{className:"text-muted",children:"司機"}),e.jsx("td",{className:"fw-semibold",children:b(t.driverName)})]}),e.jsxs("tr",{children:[e.jsx("td",{className:"text-muted",children:"車輛"}),e.jsx("td",{className:"fw-semibold",children:b(t.vehicleNo)})]}),e.jsxs("tr",{children:[e.jsx("td",{className:"text-muted",children:"指派時間"}),e.jsx("td",{className:"fw-semibold",children:b(t.assignedAt)})]}),e.jsxs("tr",{children:[e.jsx("td",{className:"text-muted",children:"預計到場"}),e.jsx("td",{className:"fw-semibold",children:b(t.etaAt)})]}),e.jsxs("tr",{children:[e.jsx("td",{className:"text-muted",children:"備註"}),e.jsx("td",{className:"fw-semibold",children:b(t.remark)})]})]})})}):e.jsx("div",{className:"text-muted",children:"尚無派遣資訊"})})]})},pe=({detail:s})=>{const t=s.logs||[];return e.jsxs("div",{className:"card",children:[e.jsx("div",{className:"card-header",children:e.jsx("div",{className:"card-title",children:e.jsx("h3",{className:"fw-bold m-0",children:"狀態歷程"})})}),e.jsx("div",{className:"card-body",children:t.length===0?e.jsx("div",{className:"text-muted",children:"尚無紀錄"}):e.jsx("div",{className:"table-responsive",children:e.jsxs("table",{className:"table table-row-dashed table-row-gray-300 align-middle gs-0 gy-3",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"text-muted fw-bold",children:[e.jsx("th",{className:"min-w-180px",children:"時間"}),e.jsx("th",{className:"min-w-160px",children:"動作"}),e.jsx("th",{className:"min-w-160px",children:"操作者"}),e.jsx("th",{className:"min-w-220px",children:"備註"})]})}),e.jsx("tbody",{children:t.map((a,r)=>e.jsxs("tr",{children:[e.jsx("td",{children:a.time}),e.jsx("td",{className:"fw-semibold",children:a.action}),e.jsx("td",{children:a.operator??"-"}),e.jsx("td",{children:a.remark??"-"})]},`${a.time}-${r}`))})]})})})]})},T=[{key:"CREATED",label:"建立"},{key:"UNASSIGNED",label:"待指派"},{key:"ASSIGNED",label:"已指派"},{key:"IN_PROGRESS",label:"運送中"},{key:"DONE",label:"完成"}],be=({status:s})=>{const t=T.findIndex(a=>a.key===s);return e.jsx("div",{className:"card mb-6",children:e.jsx("div",{className:"card-body py-4",children:e.jsx("div",{className:"d-flex align-items-center justify-content-between",children:T.map((a,r)=>{const i=r<t,d=r===t;return e.jsxs("div",{className:"d-flex align-items-center flex-fill",children:[e.jsx("div",{className:"rounded-circle d-flex align-items-center justify-content-center fw-bold",style:{width:36,height:36,backgroundColor:d?"#0d6efd":i?"#198754":"#dee2e6",color:d||i?"#fff":"#6c757d"},children:r+1}),e.jsx("div",{className:"ms-3 me-3 fw-semibold text-gray-700",children:a.label}),r<T.length-1&&e.jsx("div",{className:"flex-fill mx-2",children:e.jsx("div",{style:{height:2,backgroundColor:i?"#198754":"#dee2e6"}})})]},a.key)})})})})},ge=()=>{const{id:s}=q(),{alert:t,showAlert:a,Alert:r}=L(),[i,d]=n.useState(!0),[c,N]=n.useState(null),m=n.useCallback(async()=>{if(!s){N(null),d(!1);return}d(!0);try{const h=await xe(s);N(h)}catch(h){console.error(h),a("取得貨櫃詳情失敗","danger"),N(null)}finally{d(!1)}},[s,a]);return n.useEffect(()=>{m()},[m]),e.jsxs(R,{children:[t&&e.jsx(r,{message:t.message,type:t.type}),e.jsx(O,{title:"貨櫃詳情",breadcrumbs:[{label:"TOM 運輸管理",href:"/tom"},{label:"貨櫃管理",href:"/tom/container/list"},{label:"詳情",active:!0}]}),e.jsx("div",{className:"app-container container-fluid",children:i?e.jsx("div",{className:"d-flex justify-content-center py-10",children:e.jsx(Z,{animation:"border"})}):c?e.jsxs("div",{className:"row g-6",children:[e.jsx(be,{status:c.status}),e.jsx("div",{className:"col-12 col-lg-6",children:e.jsx(he,{detail:c,reload:m})}),e.jsx("div",{className:"col-12 col-lg-6",children:e.jsx(ue,{detail:c,reload:m})}),e.jsx("div",{className:"col-12",children:e.jsx(Ne,{detail:c,reload:m})}),e.jsx("div",{className:"col-12 col-lg-6",children:e.jsx(je,{detail:c,reload:m})}),e.jsx("div",{className:"col-12 col-lg-6",children:e.jsx(pe,{detail:c})})]}):e.jsx("div",{className:"text-center py-10 text-muted",children:"查無貨櫃資料"})})]})},P=[{title:"貨櫃管理",path:"/tom/container",isSeparator:!1,isActive:!1},{title:"",path:"",isSeparator:!0,isActive:!1}],ps=()=>e.jsxs(Y,{children:[e.jsx(C,{path:"list",element:e.jsxs(e.Fragment,{children:[e.jsx(w,{breadcrumbs:P,children:"系統列表"}),e.jsx(le,{})]})}),e.jsx(C,{path:"create",element:e.jsxs(e.Fragment,{children:[e.jsx(w,{breadcrumbs:P,children:"新增系統"}),e.jsx(oe,{})]})}),e.jsx(C,{path:":id/detail",element:e.jsxs(e.Fragment,{children:[e.jsx(w,{breadcrumbs:P,children:"系統詳情"}),e.jsx(ge,{})]})})]});export{ps as default};
